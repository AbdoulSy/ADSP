{{define "v_graph"}}<style>.node circle{fill:#999}.node text{font:10px sans-serif}.node--internal circle{fill:#555}.node--internal text{text-shadow:0 1px 0 #fff,0 -1px 0 #fff,1px 0 0 #fff,-1px 0 0 #fff}.link{fill:none;stroke:#555;stroke-opacity:.4;stroke-width:1.5px}</style><h3>Template Browser</h3><svg width="960" height="1060"></svg><script>function project(t,e){var r=(t-90)/180*Math.PI,n=e;return[n*Math.cos(r),n*Math.sin(r)]}var svg=d3.select("svg"),width=+svg.attr("width"),height=+svg.attr("height"),g=svg.append("g").attr("transform","translate("+(width/2+40)+","+(height/2+90)+")"),stratify=d3.stratify().parentId(function(t){return t.id.substring(0,t.id.lastIndexOf("."))}),tree=d3.tree().size([360,500]).separation(function(t,e){return(t.parent==e.parent?1:2)/t.depth});d3.csv("/public/data/flare.csv",function(t,e){if(t)throw t;var r=tree(stratify(e)),n=(g.selectAll(".link").data(r.descendants().slice(1)).enter().append("path").attr("class","link").attr("d",function(t){return"M"+project(t.x,t.y)+"C"+project(t.x,(t.y+t.parent.y)/2)+" "+project(t.parent.x,(t.y+t.parent.y)/2)+" "+project(t.parent.x,t.parent.y)}),g.selectAll(".node").data(r.descendants()).enter().append("g").attr("class",function(t){return"node"+(t.children?" node--internal":" node--leaf")}).attr("transform",function(t){return"translate("+project(t.x,t.y)+")"}));n.append("circle").attr("r",2.5),n.append("text").attr("dy",".31em").attr("x",function(t){return t.x<180==!t.children?6:-6}).style("text-anchor",function(t){return t.x<180==!t.children?"start":"end"}).attr("transform",function(t){return"rotate("+(t.x<180?t.x-90:t.x+90)+")"}).text(function(t){return t.id.substring(t.id.lastIndexOf(".")+1)})})</script>{{end}}